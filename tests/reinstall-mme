#!/bin/bash

sudo service mme stop

sudo rm -rf /usr/local

sudo updatedb


# ------ Fetching Git repository openair-mme ---------------------------------------------------------------------------------------------------------------------------------------------------------------
time bash -c "cd /home/nornetpp/src && \
if [ ! -d \"openair-mme\" ] ; then git clone --quiet https://github.com/simula/openairinterface-openair-mme.git openair-mme && cd openair-mme ; else cd openair-mme && git pull ; fi && \
git checkout dreibh/asn1c-url-fix-14Oct2020"
# ------ Building MME dependencies -------------------------------------------------------------------------------------------------------------------------------------------------------------------------
time bash -c "echo \"ZXhwb3J0IE1BS0VGTEFHUz0iLWpgbnByb2NgIiAmJiBcCmNkIC9ob21lL25vcm5ldHBwL3NyYy9vcGVuYWlyLW1tZS9zY3JpcHRzICYmIFwKbWtkaXIgLXAgbG9ncyAmJiBcCi4vYnVpbGRfbW1lIC0tY2hlY2staW5zdGFsbGVkLXNvZnR3YXJlIC0tZm9yY2UgPmxvZ3MvYnVpbGRfbW1lLTEubG9nIDI+JjEK\" | base64 -d | /bin/bash -x"
# ------ Building MME itself -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
time bash -c "echo \"ZXhwb3J0IE1BS0VGTEFHUz0iLWpgbnByb2NgIiAmJiBcCmNkIC9ob21lL25vcm5ldHBwL3NyYy9vcGVuYWlyLW1tZS9zY3JpcHRzICYmIFwKLi9idWlsZF9tbWUgLS1jbGVhbiA+bG9ncy9idWlsZF9tbWUtMi5sb2cgMj4mMQo=\" | base64 -d | /bin/bash -x"
# ------ Configuring MME -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
time bash -c "echo \"ZXhwb3J0IE1BS0VGTEFHUz0iLWpgbnByb2NgIiAmJiBcCmNkIC9ob21lL25vcm5ldHBwL3NyYy9vcGVuYWlyLW1tZS9zY3JpcHRzICYmIFwKZWNobyAiMTI3LjAuMS4xICAgICAgICBtbWUuc2ltdWxhLm5vcm5ldCBtbWUiIHwgc3VkbyB0ZWUgLWEgL2V0Yy9ob3N0cyAmJiBcCmVjaG8gIjE3Mi4xNi42LjEyOSAgICAgaHNzLnNpbXVsYS5ub3JuZXQgaHNzIiB8IHN1ZG8gdGVlIC1hIC9ldGMvaG9zdHMgJiYgXApvcGVuc3NsIHJhbmQgLW91dCAkSE9NRS8ucm5kIDEyOCAmJiBcCklOU1RBTkNFPTEgJiYgXApQUkVGSVg9Jy91c3IvbG9jYWwvZXRjL29haScgJiYgXApzdWRvIG1rZGlyIC1tIDA3NzcgLXAgJFBSRUZJWCAmJiBcCnN1ZG8gbWtkaXIgLW0gMDc3NyAtcCAkUFJFRklYL2ZyZWVEaWFtZXRlciAmJiBcCnN1ZG8gY3AgLi4vZXRjL21tZV9mZC5zcHJpbnQuY29uZiAgJFBSRUZJWC9mcmVlRGlhbWV0ZXIvbW1lX2ZkLmNvbmYgJiYgXApzdWRvIGNwIC4uL2V0Yy9tbWUuY29uZiAgJFBSRUZJWCAmJiBcCmRlY2xhcmUgLUEgTU1FX0NPTkYgJiYgXApNTUVfQ09ORltATU1FX1M2QV9JUF9BRERSQF09IjEyNy4wLjAuMTEiICYmIFwKTU1FX0NPTkZbQElOU1RBTkNFQF09JElOU1RBTkNFICYmIFwKTU1FX0NPTkZbQFBSRUZJWEBdPSRQUkVGSVggJiYgXApNTUVfQ09ORltAUkVBTE1AXT0nc2ltdWxhLm5vcm5ldCcgJiYgXApNTUVfQ09ORltAUElEX0RJUkVDVE9SWUBdPScvdmFyL3J1bicgJiYgXApNTUVfQ09ORltATU1FX0ZRRE5AXT0ibW1lLnNpbXVsYS5ub3JuZXQiICYmIFwKTU1FX0NPTkZbQEhTU19IT1NUTkFNRUBdPSdoc3MnICYmIFwKTU1FX0NPTkZbQEhTU19GUUROQF09Imhzcy5zaW11bGEubm9ybmV0IiAmJiBcCk1NRV9DT05GW0BIU1NfSVBfQUREUkBdPScxNzIuMTYuNi4xMjknICYmIFwKTU1FX0NPTkZbQE1DQ0BdPScyNDInICYmIFwKTU1FX0NPTkZbQE1OQ0BdPSc4OCcgJiYgXApNTUVfQ09ORltATU1FX0dJREBdPSczMjc2OCcgJiYgXApNTUVfQ09ORltATU1FX0NPREVAXT0nMycgJiYgXApNTUVfQ09ORltAVEFDXzBAXT0nNjAwJyAmJiBcCk1NRV9DT05GW0BUQUNfMUBdPSc2MDEnICYmIFwKTU1FX0NPTkZbQFRBQ18yQF09JzYwMicgJiYgXApNTUVfQ09ORltATU1FX0lOVEVSRkFDRV9OQU1FX0ZPUl9TMV9NTUVAXT0nZW5zNicgJiYgXApNTUVfQ09ORltATU1FX0lQVjRfQUREUkVTU19GT1JfUzFfTU1FQF09JzE5Mi4xNjguMjQ3LjExMi8yNCcgJiYgXApNTUVfQ09ORltATU1FX0lOVEVSRkFDRV9OQU1FX0ZPUl9TMTFAXT0nZW5zNScgJiYgXApNTUVfQ09ORltATU1FX0lQVjRfQUREUkVTU19GT1JfUzExQF09JzE3Mi4xNi4xLjEwMi8yNCcgJiYgXApNTUVfQ09ORltATU1FX0lOVEVSRkFDRV9OQU1FX0ZPUl9TMTBAXT0nZHVtbXkwJyAmJiBcCk1NRV9DT05GW0BNTUVfSVBWNF9BRERSRVNTX0ZPUl9TMTBAXT0nMTkyLjE2OC4xMC4xMTAvMjQnICYmIFwKTU1FX0NPTkZbQE9VVFBVVEBdPSdDT05TT0xFJyAmJiBcCk1NRV9DT05GW0BTR1dfSVBWNF9BRERSRVNTX0ZPUl9TMTFfVEVTVF8wQF09JzE3Mi4xNi4xLjEwMicgJiYgXApNTUVfQ09ORltAU0dXX0lQVjRfQUREUkVTU19GT1JfUzExXzBAXT0nMTcyLjE2LjEuMTAyJyAmJiBcCk1NRV9DT05GW0BQRUVSX01NRV9JUFY0X0FERFJFU1NfRk9SX1MxMF8wQF09JzAuMC4wLjAvMjQnICYmIFwKTU1FX0NPTkZbQFBFRVJfTU1FX0lQVjRfQUREUkVTU19GT1JfUzEwXzFAXT0nMC4wLjAuMC8yNCcgJiYgXApNTUVfQ09ORltAVEFDLUxCX1NHV19URVNUXzBAXT0wNyAmJiBcCk1NRV9DT05GW0BUQUMtSEJfU0dXX1RFU1RfMEBdPTAwICYmIFwKTU1FX0NPTkZbQE1DQ19TR1dfMEBdPTI0MiAmJiBcCk1NRV9DT05GW0BNTkMzX1NHV18wQF09MDg4ICYmIFwKTU1FX0NPTkZbQFRBQy1MQl9TR1dfMEBdPTU4ICYmIFwKTU1FX0NPTkZbQFRBQy1IQl9TR1dfMEBdPTAyICYmIFwKTU1FX0NPTkZbQE1DQ19NTUVfMEBdPTI0MiAmJiBcCk1NRV9DT05GW0BNTkMzX01NRV8wQF09MDg4ICYmIFwKTU1FX0NPTkZbQFRBQy1MQl9NTUVfMEBdPTU5ICYmIFwKTU1FX0NPTkZbQFRBQy1IQl9NTUVfMEBdPTAyICYmIFwKTU1FX0NPTkZbQE1DQ19NTUVfMUBdPTI0MiAmJiBcCk1NRV9DT05GW0BNTkMzX01NRV8xQF09MDg4ICYmIFwKTU1FX0NPTkZbQFRBQy1MQl9NTUVfMUBdPTVhICYmIFwKTU1FX0NPTkZbQFRBQy1IQl9NTUVfMUBdPTAyICYmIFwKZm9yIEsgaW4gIiR7IU1NRV9DT05GW0BdfSI7IGRvIHN1ZG8gZWdyZXAgLWxSWiAiJEsiICRQUkVGSVggfCB4YXJncyAtMCAtbCBzdWRvIHNlZCAtaSAtZSAic3wkS3wke01NRV9DT05GWyRLXX18ZyIgOyByZXQ9JD87W1sgcmV0IC1uZSAwIF1dICYmIGVjaG8gIlRyaWVkIHRvIHJlcGxhY2UgJEsgd2l0aCAke01NRV9DT05GWyRLXX0iIHx8IHRydWUgOyBkb25lICYmIFwKc3VkbyAuL2NoZWNrX21tZV9zNmFfY2VydGlmaWNhdGUgJFBSRUZJWC9mcmVlRGlhbWV0ZXIgbW1lLnNpbXVsYS5ub3JuZXQgPmxvZ3MvY2hlY2tfbW1lX3M2YV9jZXJ0aWZpY2F0ZS5sb2cgMj4mMQo=\" | base64 -d | /bin/bash -x"
